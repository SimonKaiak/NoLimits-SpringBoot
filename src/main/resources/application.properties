# ============================================================
# CONFIGURACIÓN PRINCIPAL DE LA APLICACIÓN
# ============================================================

# Nombre identificador del proyecto en Spring Boot
spring.application.name=NoLimits


# ============================================================
# BASE DE DATOS (PRODUCCIÓN - RENDER)
# ============================================================
# Estas variables NO están escritas aquí directamente.
# Se inyectan desde Render → Environment Variables.
#
# IMPORTANTE:
# En producción nunca se debe usar localhost, ya que Render
# se encuentra en un servidor remoto.
# ============================================================

# URL completa de conexión a PostgreSQL en Render
spring.datasource.url=${SPRING_DATASOURCE_URL}

# Usuario de la base de datos (proporcionado por Render)
spring.datasource.username=${SPRING_DATASOURCE_USERNAME}

# Contraseña de la base de datos (segura, desde Render)
spring.datasource.password=${SPRING_DATASOURCE_PASSWORD}

# Driver oficial para PostgreSQL
spring.datasource.driver-class-name=org.postgresql.Driver


# Render recomienda forzar SSL para conexiones externas.
# Esto asegura comunicación cifrada entre Render y PostgreSQL.
spring.datasource.hikari.data-source-properties.sslmode=require


# ============================================================
# JPA / HIBERNATE (ENTORNO DE PRODUCCIÓN)
# ============================================================

# "update" mantiene los datos existentes y solo actualiza la estructura.
# No borra información, solo ajusta tablas si es necesario.
spring.jpa.hibernate.ddl-auto=update

# No mostrar sentencias SQL en consola por rendimiento y seguridad
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.format_sql=false

# Dialecto específico para PostgreSQL en Render
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect


# Evita errores al serializar entidades con relaciones perezosas (Lazy Loading)
spring.jackson.serialization.FAIL_ON_EMPTY_BEANS=false


# ============================================================
# CONFIGURACIÓN DEL SERVIDOR (RENDER)
# ============================================================

# Permite que el servidor escuche desde cualquier interfaz de red
server.address=0.0.0.0

# Render asigna el puerto dinámicamente.
# Si PORT no existe, se usará 8080 por defecto.
server.port=${PORT:8080}

# Permite que Spring maneje correctamente cabeceras proxy
server.forward-headers-strategy=framework


# ============================================================
# COOKIES DE SESIÓN (SEGURIDAD CORS)
# ============================================================

# Permite enviar cookies desde distintos dominios (Vercel ↔ Render)
server.servlet.session.cookie.same-site=None

# Obliga a usar HTTPS para cookies de sesión
# Render ya trabaja sobre HTTPS, por lo que es correcto.
server.servlet.session.cookie.secure=true


# ============================================================
# PERFILES
# ============================================================

# IMPORTANTE:
# NO activar el perfil dev en producción.
# Esto ejecutaría el DataLoader y podría alterar datos reales.
# spring.profiles.active=dev


# ============================================================
# SWAGGER / SPRINGDOC
# ============================================================

# Habilita la generación de la documentación OpenAPI
springdoc.api-docs.enabled=true

# Habilita la interfaz gráfica Swagger UI
springdoc.swagger-ui.enabled=true

# Ruta de acceso a Swagger UI
springdoc.swagger-ui.path=/doc/swagger-ui.html


# ============================================================
# ACTUATOR + UPTIMEROBOT (PREVENIR SLEEP EN RENDER)
# ============================================================

# Expone los endpoints de monitoreo health e info
management.endpoints.web.exposure.include=health,info

# Muestra información detallada del estado del servidor
management.endpoint.health.show-details=always

# Desactiva la seguridad automática de Spring Security
# Esto permite que /actuator/health sea accesible públicamente
# spring.autoconfigure.exclude=org.springframework.boot.autoconfigure.security.servlet.SecurityAutoConfiguration,org.springframework.boot.actuate.autoconfigure.security.servlet.ManagementWebSecurityAutoConfiguration


# ============================================================
# LOGGING (PRODUCCIÓN)
# ============================================================

# Nivel de logs reducido para evitar saturar consola
logging.level.org.hibernate=INFO
logging.level.org.springframework.transaction=INFO
logging.level.org.springframework.orm.jpa=INFO

# ============================================================
# JWT (SEGURIDAD)
# ============================================================

# Clave secreta para firmar los JWT
# En producción se toma desde la variable de entorno SECURITY_JWT_SECRET
security.jwt.secret=${SECURITY_JWT_SECRET}

# Tiempo de expiración del token en milisegundos
# 3600000 = 1 hora
security.jwt.expiration=${SECURITY_JWT_EXPIRATION:3600000}
